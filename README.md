# ML-prediction-of-RUL-of-NPP-equipment
Различные модели машинного обучения для прогнозирования остаточного ресурса промышленного оборудования, в том чисте оборудования АЭС



## Подготовка библиотек
### Для пользователей Linux/macOS
- перейти в корень проекта
- python3 -m venv venv
- активировать виртуальное окружение: source venv/bin/activate
- скачать библиотеки: pip install -r requirements.txt

### Для пользователей Windows
- перейти в корень проекта
- python -m venv venv
- если политика выполнения скриптов запрещает запуск, выполнить сначала (PowerShell): Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy RemoteSigned
- активировать виртуальное окружение: .\venv\Scripts\Activate.ps1
- скачать библиотеки: pip install -r requirements.txt


## Подготовка датасетов
- Скачать датасеты по ссылке: https://disk.yandex.ru/d/1gDLa0CU9NJxIQ
- Распаковать в корень проекта


## Запуск моделей
- перейти в корень проекта
- прописать команду: python src/run_pipeline.py


## Описание датасетов
1. https://www.kaggle.com/datasets/shivamb/power-transformers-fdd-and-rul
Датасет содержит сенсорные данные концентраций газов в масле трансформаторов, которые используются для оценки остаточного ресурса (RUL) и выявления неисправностей. Трансформаторы являются важными элементами системы электроснабжения АЭС, обеспечивающими стабильную передачу электроэнергии. Прогнозирование их состояния помогает предотвращать аварии и минимизировать простои. Данные можно использовать для разработки моделей, способных предсказать отказы трансформаторов на атомной станции.
2. https://www.kaggle.com/datasets/nphantawee/pump-sensor-data
Этот датасет содержит временные ряды сенсорных данных (например, вибрация, давление, расход жидкости) для промышленного насоса с указанием остаточного ресурса (RUL) в часах. Для АЭС эти данные полезны тем, что насосы (главный циркуляционный насос, насосы подачи воды) отвечают за циркуляцию и охлаждение теплоносителя, их прогнозирование остаточного ресурса критически важно для предотвращения аварий и улучшения планирования технического обслуживания на АЭС.
3. https://www.kaggle.com/datasets/anseldsouza/water-pump-rul-predictive-maintenance
Датасет содержит временные ряды с сенсорными показаниями промышленных водяных насосов, сопровождаемые значениями их остаточного ресурса (RUL). Данные включают показатели температуры, давления, вибрации и расхода жидкости. Для АЭС такие насосы могут быть аналогичны системам подачи охлаждающей воды и циркуляционным насосам, обеспечивающим охлаждение ядерного реактора. Модель на его основе позволит своевременно выявлять деградацию насосного оборудования и предотвращать аварийные ситуации на станции.
4. https://www.kaggle.com/datasets/akhileshrai1999/anomaly-detection-pwr
Данные с сенсоров реактора с водой под давлением (PWR), охватывающие нормальные и аномальные режимы работы. Эти данные включают параметры, такие как мощность, давление и вибрации, отражающие рабочее состояние реактора и связанных систем. Использование датасета можно использовать для создания модели для обнаружения аномалий, связанных с деградацией оборудования АЭС, и предотвращать потенциально опасные ситуации заранее.
5. https://www.kaggle.com/datasets/hiimanshuagarwal/predictive-maintenance-dataset
Данные имитируют работу металлообрабатывающего станка, но параметры (температура, нагрузка, обороты) аналогичны тем, что снимают с вращающегося оборудования АЭС — циркуляционных насосов, вентиляторов систем безопасности, приводов клапанов. Позволяет отрабатывать модели бинарного предсказания отказа и оценку деградации компонентов, а также служит небольшим «песочником» для тестирования RUL-алгоритмов до переноса на реальные датчики станции. Полезен как тренировочный набор для быстрой валидации идей по прогнозному ТО без рисков раскрытия конфиденциальных данных АЭС.
6. https://www.kaggle.com/datasets/behrad3d/nasa-cmaps
Датасет NASA C-MAPSS включает синтетические данные сенсоров деградации и отказов турбовентиляторных двигателей. Хотя изначально предназначен для авиационной отрасли, его структура и методики прогнозирования остаточного ресурса легко адаптируются для паровых турбин и генераторов АЭС. Он полезен для разработки и валидации моделей RUL вращающегося оборудования, являющегося ключевым элементом любой атомной электростанции.


## Применяемые подходы прогнозирования остаточного ресурса промышленного оборудования, в том числе оборудования АЭС
- Подход 1 "статистический анализ отказов" - основан на подгонке распределения «время до отказа» (TTF), чаще всего Вейбулла, к историческим циклам оборудования и вычислении функции выживания для оценки условного RUL. Применим к датасету 5 (generic predictive maintenance), где есть множество полных пробегов до отказа и только метки TTF без сигналов деградации.
- Подход 2 "экстраполяция деградационного параметра" - аппроксимирует один ключевой сигнал (температура, вибрация или концентрация газов) простым линейным или экспоненциальным трендом и решением уравнения до критического порога рассчитывает RUL. Лучше всего подходит к датасетам 1 (газы в масле трансформаторов) и 4 (PWR-анализ аномалий), где присутствуют монотонно изменяющиеся параметры.
- Подход 3 "классическая ML-регрессия" - представляет задачу прогнозирования RUL как регрессию на табличных признаках (статистика окон, тренды, мгновенные значения) с использованием ансамблевых моделей (RandomForest, GBM). Универсален для датасетов 1, 2, 3, 5 и 6, где есть метки RUL или полные траектории до отказа и можно извлечь признаки для обучения.
- Подход 4 "similarity-based, DTW + kNN" - «ленивый» метод поиска ближайших исторических траекторий по метрике Dynamic Time Warping и переноса их остаточного ресурса на текущий объект. Идеален для датасетов 2 (насосы), 4 (PWR) и 6 (C-MAPSS), где имеется множество эталонных временных рядов до отказа.


## Используемые модели машинного обучения
- Модель 1 (подход 1: статистический анализ отказов) — Weibull Accelerated Failure Time Regression. Параметрическая модель на основе распределения Вейбулла, подгоняемая к набору значений «время до отказа» (TTF). По оценённым параметрам строится функция выживания и вычисляется условный средний остаточный ресурс (RUL) при заданном текущем возрасте оборудования. Не требует детальных сигналов деградации, подходит когда есть только TTF-данные.
- Модель 2 (подход 2: экстраполяция деградационного параметра) — Линейная/экспоненциальная регрессия. Аппроксимирует монотонно меняющийся диагностический параметр (например, вибрация, температура, концентрация газов) простым трендом. Решением линейного или экспоненциального уравнения до критического порога определяется прогноз RUL. Минимум гиперпараметров и быстрая интерпретация модели.
- Модель 3 (подход 3: классическая ML-регрессия) — RandomForestRegressor / GradientBoostingRegressor. Ансамблевые деревья обучаются на табличном наборе признаков (статистика временных окон, тренды, мгновенные значения) и таргете RUL. Не требуют нормализации, дают стабильный прогноз и позволяют оценить важность признаков. Отличный базовый вариант для разнообразных датасетов с метками RUL.
- Модель 4 (подход 4: similarity-based) — DTW + kNN-регрессор. «Ленивый» метод, где для текущего отрезка сигнала вычисляются DTW-расстояния до исторических траекторий до отказа, после чего ближайшие соседи передают свой остаточный ресурс. Позволяет учитывать сложные нелинейные паттерны деградации без этапа обучения. Идеален при наличии большого архива эталонных траекторий.


## Структура проекта
ML-prediction-of-RUL-of-NPP-equipment/

├── README.md                   # Описание проекта и инструкция по запуску

├── requirements.txt            # Перечень Python-библиотек

├── venv                        # Виртуальное окружение Python

│

├── datasets/

│   ├── raw/                    # «сырые» данные, как они загружены из источников

│   │   ├── transformers_gas/   # датасет 1: Power Transformers FDD & RUL

│   │   ├── pump_sensor/        # датасет 2: Pump Sensor Data

│   │   ├── pump_pm/            # датасет 3: Pump Predictive Maintenance

│   │   ├── pwr_anomaly/        # датасет 4: PWR Anomaly Detection

│   │   ├── generic_pm/         # датасет 5: Predictive Maintenance Dataset (generic)

│   │   └── cmaps/              # датасет 6: NASA C-MAPSS

│   │

│   └── processed/              # преобразованные данные для моделей

│       ├── statistical/        # подготовка для модели 1 (статистика отказов)

│       ├── degradation/        # подготовка для модели 2 (экстраполяция параметра)

│       ├── regression/         # признаки и таргеты для модели 3 (ML-регрессия)

│       └── similarity/         # обрезанные траектории и матрицы расстояний для модели 4

│

├── src/                        # Небольшие вспомогательные скрипты

│   ├── data_prep.py            # Функции для чтения raw → processed

│   ├── models.py               # Классы/функции: statistical, degradation, regression, similarity

│   ├── utils.py                # Общие метрики и графики (RMSE, plot true vs pred и т.п.)

│   └── run_pipeline.py         # Основной скрипт

│

├── models/                     # Сохранённые обученные модели (.pkl)

└── results/                    # Итоговые графики и таблицы с метриками

